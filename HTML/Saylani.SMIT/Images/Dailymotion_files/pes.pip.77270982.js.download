(function () {
'use strict';
let p={API_CALL:"api_call",BACK_ICON:"back_icon",CLOSE_ICON:"close_icon",INSTANT_START:"instant_start",PIP_NATIVE_ICON:"pip_native_icon",SCROLL:"scroll",TOGGLE_ICON:"toggle_icon"},r=16/9,d=[],P=e=>(d=[...d,e],()=>{d=d.filter(t=>t!==e)}),u=()=>{d.forEach(e=>e()),d=[]},c=[],g=(e,t,i,o)=>{let n=e.on(t,i,o);c=[...c,n];let l=()=>{n(),c=c.filter(e=>e!==n)};return P(l),l},m=e=>e._do_not_use_be78cd25d6a90f64531c.rootNode,y=e=>{var t;return null===(t=m(e))||void 0===t?void 0:t.querySelector(".dailymotion-player-wrapper")},_=e=>{var t;return null===(t=m(e))||void 0===t?void 0:t.querySelector(".dailymotion-player")},h={state:{},prevState:{},defaultState:{isRunning:!1,displayMode:null,isSmallViewportDisplay:!1,isExpanded:!1,isPipCustomPosition:!1,hasPipBanner:!1,hasRequestedPipNative:!1,uiActionOrigin:null,playerSelectedForPip:null,playerSelectedForPipNative:null,pipPositionX:null,pipPositionY:null,pipTransformSmallViewportCollapsed:null},nonPersistentStateProps:["uiActionOrigin"],onStateChange(){},setState(e){this.nonPersistentStateProps.forEach(t=>{Object.prototype.hasOwnProperty.call(e,t)||(e={...e,[t]:this.defaultState[t]})}),this.prevState={...this.prevState,...this.state},this.state={...this.state,...e},this.onStateChange(this.prevState,this.state)}},S=e=>{h.setState(e)},E=()=>h.state,f=()=>h.defaultState,C=e=>{h.onStateChange=e},b=null,I=!1,N=!1,w=null,A=Object.values(window.dailymotion._do_not_use_be78cd25d6a90f64531c.players);for(let e=0;e<A.length;e++)if("off"!==A[e]._do_not_use_be78cd25d6a90f64531c.settings.pip){I=A[e]._do_not_use_be78cd25d6a90f64531c.settings.enableStartPipExpanded;break}let R=()=>window.innerWidth<=_dmpesplayer.B.SMALL?"small":"large",x=()=>"small"===R(),L=e=>!!x()&&(!!$()||!!N||null!=e&&!!e.adIsPlaying),O=(t,o)=>{let n=e=>{e&&S({isExpanded:L(),displayMode:R(),isSmallViewportDisplay:x()}),T(t)};F(t,o),g(t,_dmpesplayer.b.PUBLIC.VIDEO_PLAY,()=>{S({hasPipBanner:t.getSettings().enableGooglePolicyUi&&t.getSettings().enablePlaybackControls})}),n();let l=_dmpesplayer.a(window,"resize",n);P(()=>{l(),B(t),document.body.offsetWidth,w&&(w(),w=null)})},v=(e,t,i)=>{E().isRunning&&!N&&(b=!!t,S({hasPipBanner:e.getSettings().enableGooglePolicyUi&&e.getSettings().enablePlaybackControls,isExpanded:b,uiActionOrigin:i}),T(e,{animate:!1}))},T=function(t){let{animate:i=!1,computePlayerIframeSizes:o=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};B(t,{animate:i,computePlayerIframeSizes:o});let n=m(t),l=y(t),a=_(t),s=$()||N,p=E().hasPipBanner,{dynamicWidth:d,dynamicHeight:P}=D(),u=document.documentElement.clientWidth,c=Math.round(u/r)+(p?32:0);l.id=`dailymotion-pip-${R()}-viewport`;let{defaultPositionX:g,defaultPositionY:h,defaultMargin:f}={large:{defaultPositionX:"right",defaultPositionY:"bottom",defaultMargin:"20px"},small:{defaultPositionX:"left",defaultPositionY:"top",defaultMargin:"0px"}}[R()],C=e=>getComputedStyle(document.querySelector(`#${l.id}`)).getPropertyValue(e),b=e=>""!==C(`--position-${e}`).trim();b("top")||b("bottom")||l.style.setProperty(`--position-${h}`,f),b("left")||b("right")||l.style.setProperty(`--position-${g}`,f),!b("bottom")&&w&&(w(),w=null),b("bottom")&&x()&&!w&&(w=_dmpesplayer.a(window,"scroll",()=>{T(t,{computePlayerIframeSizes:!1})}));let I=x()&&(b("bottom")||b("right")||C("--position-top")!==f||C("--position-left")!==f),A=b("left")||b("top")||C("--position-bottom")!==f||C("--position-right")!==f,L=b("left")?"left":"right",O=b("top")?"top":"bottom",v=getComputedStyle(l),F=()=>"0.00001"!==parseFloat(v.marginRight).toPrecision(1)?`${parseFloat(v.marginRight)}px`:"left"!==L||isNaN(C("--position-left").trim())?"right"!==L||isNaN(C("--position-right").trim())?`var(--position-${L})`:`${Number(C("--position-right"))}px`:`${Number(C("--position-left"))}px`,V=()=>"0.00001"!==parseFloat(v.marginBottom).toPrecision(1)?`${parseFloat(v.marginBottom)}px`:"top"!==O||isNaN(C("--position-top").trim())?"bottom"!==O||isNaN(C("--position-bottom").trim())?`var(--position-${O})`:`${Number(C("--position-bottom"))}px`:`${Number(C("--position-top"))}px`,M=()=>"large"===R()?p?P+32:P:s?c:p?136:104,G=()=>"large"===R()?d:u;Object.assign(l.style,{boxShadow:"0 0.25rem 0.5rem rgba(0, 0, 0, 0.2)",height:`${M()}px`,position:"fixed",transform:(()=>{let e,t;let i=[],o=l.parentNode;for(;o!==document&&o;)i.push(o),o=o.parentNode;let a=document.documentElement.scrollLeft?document.documentElement.scrollLeft:i.reduce((e,t)=>{let{scrollLeft:i}=t;return e+i},0),s=document.documentElement.scrollTop?document.documentElement.scrollTop:i.reduce((e,t)=>{let{scrollTop:i}=t;return e+i},0);return"rtl"===v.direction?("right"===L&&(e=document.documentElement.clientWidth),"left"===L&&(e=G()),e-=n.getBoundingClientRect().right):("right"===L&&(e=document.documentElement.clientWidth-G()),"left"===L&&(e=0),e-=n.getBoundingClientRect().left),e-=a,"bottom"===O&&(t=window.innerHeight-M()),"top"===O&&(t=0),t=t-n.getBoundingClientRect().top-s,`translate(
      calc(${e}px ${"right"===L?"-":"+"} ${F()}),
      calc(${t}px ${"bottom"===O?"-":"+"} ${V()})
    )`})(),transition:"none",width:`${G()}px`,zIndex:0x7fffffff,bottom:"unset",left:"unset",right:"unset",top:"unset",borderRadius:`${"large"===R()?"0.5rem":"0rem"}`});let U=null;x()&&(Object.assign(a,{height:`${c}px`,width:`${u}px`}),U=Math.round((c-104)/2),Object.assign(a.style,{height:`${c}px`,transition:"none",transform:s?"translate(0px,0px)":`translate(0px, -${U}px)`,width:`${u}px`})),S({isPipCustomPosition:I||A,pipPositionX:l.getBoundingClientRect().x,pipPositionY:l.getBoundingClientRect().y,uiActionOrigin:E().uiActionOrigin,pipTransformSmallViewportCollapsed:U})},$=()=>!!b||null===b&&!!I,B=function(e){let{animate:t=!1,computePlayerIframeSizes:i=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=y(e),n=_(e);o.removeAttribute("id"),o.style.removeProperty("--position-top"),o.style.removeProperty("--position-left"),o.style.removeProperty("--position-bottom"),o.style.removeProperty("--position-right"),Object.assign(o.style,{boxShadow:"unset",...t?{}:{height:"100%"},position:"absolute",transform:"translate(0px,0px)",width:"100%",zIndex:"auto",margin:"0.00001px",borderRadius:"0px"}),i&&(Object.assign(n,{height:"100%",width:"100%"}),Object.assign(n.style,{height:"100%",transform:"translate(0px,0px)",transition:"none",width:"100%"}))},D=()=>{let e=window.innerWidth;if(e<=_dmpesplayer.B.MEDIUM)return{dynamicWidth:410,dynamicHeight:Math.round(410/r)};if(e>=_dmpesplayer.B.LARGE)return{dynamicWidth:560,dynamicHeight:Math.round(560/r)};let i=_dmpesplayer.B.LARGE-_dmpesplayer.B.MEDIUM,o=Math.round((e-_dmpesplayer.B.LARGE+i)/i*150)+410,n=Math.round(o/r);return{dynamicWidth:o,dynamicHeight:n}},F=(e,t)=>{(N=t.adIsPlaying)?M(e):V(e)},V=e=>{g(e,_dmpesplayer.b.PUBLIC.AD_START,()=>{N=!0,S({hasPipBanner:e.getSettings().enableGooglePolicyUi&&e.getSettings().enableAdsControls}),$()||S({isExpanded:x()}),T(e),M(e)},{once:!0})},M=e=>{g(e,_dmpesplayer.b.PUBLIC.AD_END,()=>{N=!1,S({hasPipBanner:e.getSettings().enableGooglePolicyUi&&e.getSettings().enablePlaybackControls}),$()||S({isExpanded:!1}),T(e),V(e)},{once:!0})},G=(e,t,n)=>{let{isRunning:l,isExpanded:a}=t,{displayMode:s,isRunning:r,isExpanded:d,uiActionOrigin:P,playerSelectedForPipNative:u}=n,c={playerPipDisplay:`${s}Viewport`,playerPipIsExpanded:d,playerPipStatus:P===p.CLOSE_ICON?"closed":"enabled",playerPresentationMode:r?"pip":u?"nativePip":"inline"},{id:g,stateFromPES:m}=e._do_not_use_be78cd25d6a90f64531c;Object.assign(m,c),l!==r&&_dmpesplayer.s(_dmpesplayer.b.PUBLIC.PLAYER_PRESENTATIONMODECHANGE,{id:g,...c}),a!==d&&_dmpesplayer.s(_dmpesplayer.b.PUBLIC.PLAYER_PIPEXPANDEDCHANGE,{id:g,...c})},U=(e,t,i)=>{let{isRunning:o,isSmallViewportDisplay:s,isExpanded:p,isPipCustomPosition:r,hasPipBanner:d,hasRequestedPipNative:P,pipPositionX:u,pipPositionY:c,pipTransformSmallViewportCollapsed:g}=t,{isRunning:m,isSmallViewportDisplay:y,isExpanded:_,isPipCustomPosition:h,hasPipBanner:S,hasRequestedPipNative:E,uiActionOrigin:f,pipPositionX:C,pipPositionY:b,pipTransformSmallViewportCollapsed:I}=i;if(o!==m||s!==y||p!==_||d!==S||r!==h||P!==E||u!==C||c!==b||g!==I){let t={isRunning:m,isSmallViewportDisplay:y,isExpanded:_,isPipCustomPosition:h,hasPipBanner:S,hasRequestedPipNative:E,uiActionOrigin:f,screenId:window.dailymotion._do_not_use_be78cd25d6a90f64531c.screenId,pipPositionX:C,pipPositionY:b,pipTransformSmallViewportCollapsed:I};_dmpesplayer.l.log("pip","Sending new PIP state to player :",t),_dmpesplayer.c(e,_dmpesplayer.C.NOTIFY_PIP_CHANGED,t)}},Y=()=>{},j=()=>{},X=e=>{v(E().playerSelectedForPip,!0,e)},q=e=>{v(E().playerSelectedForPip,!1,e)},W=()=>{T(E().playerSelectedForPip)},H=()=>{S({...f()}),Y=i=>{e(),t(),o(),l(),a(),r(),j(i)};let e=_dmpesplayer.d(_dmpesplayer.b.PUBLIC.PLAYER_VIEWABILITYCHANGE,e=>{let{viewable:t,wasViewableAtLeastOnce:i,id:o,uiActionOrigin:l}=e,a=window.dailymotion._do_not_use_be78cd25d6a90f64531c.players[o];if(!a||"off"===a._do_not_use_be78cd25d6a90f64531c.settings.pip||E().playerSelectedForPip&&a!==E().playerSelectedForPip||E().playerSelectedForPipNative)return;let{status:s,reason:r}=a.isEligibleForPipDisplay(i);_dmpesplayer.l.log("pip",`Viewability change received
        - is player viewable : ${t}
        - is player eligible for PIP display : ${s} (${r})`),t?j(l||p.SCROLL):!t&&a.isEligibleForPipDisplay(i).status&&a.getState().then(e=>{k(a,e,i||"instant"!==a._do_not_use_be78cd25d6a90f64531c.settings.pip?p.SCROLL:p.INSTANT_START)})}),t=_dmpesplayer.d(_dmpesplayer.b.PUBLIC.PLAYER_PRESENTATION_MODE_CHANGE,e=>{let{playerPresentationMode:t,id:i}=e,o=window.dailymotion._do_not_use_be78cd25d6a90f64531c.players[i];if(o){if("inline"===t&&E().playerSelectedForPipNative===o&&S({playerSelectedForPipNative:null}),"nativePip"===t){S({playerSelectedForPipNative:o}),E().hasRequestedPipNative&&S({hasRequestedPipNative:!1}),E().playerSelectedForPip&&j(p.PIP_NATIVE_ICON);return}o.getState().then(e=>{e.playerIsViewable||k(o,e,p.PIP_NATIVE_ICON)})}}),o=_dmpesplayer.d(_dmpesplayer.b.PRIVATE.CLOSE_PIP_REQUESTED,()=>{Y(p.CLOSE_ICON)}),l=_dmpesplayer.d(_dmpesplayer.b.PRIVATE.BACK_TO_INLINE_DISPLAY_REQUESTED,()=>{let e=E().playerSelectedForPip,{observer:t}=e._do_not_use_be78cd25d6a90f64531c;t.setUIActionOrigin(p.BACK_ICON),m(e).scrollIntoView({block:"start"})}),a=_dmpesplayer.d(_dmpesplayer.b.PRIVATE.COLLAPSE_PIP_REQUESTED,()=>{v(E().playerSelectedForPip,!1,p.TOGGLE_ICON)}),r=_dmpesplayer.d(_dmpesplayer.b.PRIVATE.EXPAND_PIP_REQUESTED,()=>{v(E().playerSelectedForPip,!0,p.TOGGLE_ICON)})},k=(e,t,i)=>{if(E().isRunning||window.dailymotion._do_not_use_be78cd25d6a90f64531c.playerSelectedForPip!==e||E().playerSelectedForPipNative)return;j=t=>{E().isRunning&&(u(),S({isPipCustomPosition:!1,isRunning:!1,hasPipBanner:!1,pipPositionX:null,pipPositionY:null,playerSelectedForPip:null,uiActionOrigin:t}),C(()=>{}),(t===p.CLOSE_ICON||t===p.API_CALL)&&e.pause())},C((t,i)=>{G(e,t,i),U(e,t,i)});let o=e.getSettings().enableGooglePolicyUi,n=!t.adIsPlaying&&e.getSettings().enablePlaybackControls,l=t.adIsPlaying&&e.getSettings().enableAdsControls;S({hasPipBanner:o&&(n||l),isRunning:!0,uiActionOrigin:i,displayMode:R(),isSmallViewportDisplay:x(),isExpanded:L(t),playerSelectedForPip:e}),O(e,t)};window.dailymotion.pipResume=()=>{_dmpesplayer.l.log("api","Called dailymotion.pipResume()"),H()},window.dailymotion.pipClose=()=>{_dmpesplayer.l.log("api","Called dailymotion.pipClose()"),Y(p.API_CALL)},window.dailymotion.pipExpand=()=>{_dmpesplayer.l.log("api","Called dailymotion.pipExpand()"),X(p.API_CALL)},window.dailymotion.pipCollapse=()=>{_dmpesplayer.l.log("api","Called dailymotion.pipCollapse()"),q(p.API_CALL)},window.dailymotion.pipRepaint=()=>{_dmpesplayer.l.log("api","Called dailymotion.pipRepaint()"),W()};
})();
